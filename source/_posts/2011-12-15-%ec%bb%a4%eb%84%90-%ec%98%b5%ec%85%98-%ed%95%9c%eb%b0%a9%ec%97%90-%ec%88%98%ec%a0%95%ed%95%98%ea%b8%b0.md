---
id: 795
title: 커널 옵션 한방에 수정하기
author: whitekid
layout: post
guid: http://blog.woosum.net/?p=795
permalink: /archives/795
dsq_thread_id:
  - 717902741
categories:
  - Uncategorized
tags:
  - kernel
  - Xen
---
요즘 Xen을 가지고 놀고 있습니다.

아직 공부하는 중이라 커널 컴파일을 자주하게 되는데 이럴때 정말로 귀찮은게 커널의 옵션들을 일일이 맞춰주는 겁니다. 정말로 귀찮습니다.

그래서 걍 스크립트질로 처리해버렸네요~~

[code lang="bash"]  
#!/bin/sh  
\# Xen 관련 설정들: <http://wiki.xensource.com/xenwiki/XenParavirtOps> 참고  
configs="CONFIG_PARAVIRT=y  
CONFIG_XEN=y  
CONFIG\_PARAVIRT\_GUEST=y  
CONFIG\_PARAVIRT\_SPINLOCKS=y  
CONFIG\_HVC\_DRIVER=y  
CONFIG\_HVC\_XEN=y  
CONFIG\_XEN\_FBDEV_FRONTEND=y  
CONFIG\_XEN\_BLKDEV_FRONTEND=y  
CONFIG\_XEN\_NETDEV_FRONTEND=y  
CONFIG\_XEN\_PCIDEV_FRONTEND=y  
CONFIG\_INPUT\_XEN\_KBDDEV\_FRONTEND=y  
CONFIG\_XEN\_FBDEV_FRONTEND=y  
CONFIG\_XEN\_XENBUS_FRONTEND=y  
CONFIG\_XEN\_SAVE_RESTORE=y  
CONFIG\_XEN\_GRANT\_DEV\_ALLOC=m  
CONFIG\_XEN\_TMEM=y  
CONFIG_CLEANCACHE=y  
CONFIG_FRONTSWAP=y  
CONFIG\_XEN\_SELFBALLOONING=y  
CONFIG\_X86\_IO_APIC=y  
CONFIG_ACPI=y  
CONFIG\_ACPI\_PROCFS=y  
CONFIG\_XEN\_DOM0=y  
CONFIG\_PCI\_XEN=y  
CONFIG\_XEN\_DEV_EVTCHN=y  
CONFIG_XENFS=y  
CONFIG\_XEN\_COMPAT_XENFS=y  
CONFIG\_XEN\_SYS_HYPERVISOR=y  
CONFIG\_XEN\_GNTDEV=y  
CONFIG\_XEN\_BACKEND=y  
CONFIG\_XEN\_NETDEV_BACKEND=m  
CONFIG\_XEN\_BLKDEV_BACKEND=m  
CONFIG\_XEN\_PCIDEV_BACKEND=m  
CONFIG\_XEN\_PRIVILEGED_GUEST=y  
CONFIG\_XEN\_BALLOON=y  
CONFIG\_XEN\_SCRUB_PAGES=y  
CONFIG\_XEN\_DEV_EVTCHN=y  
CONFIG\_XEN\_GNTDEV=y  
"  
\# Xen 추가 설정  
configs="$configs  
CONFIG\_XEN\_BLKDEV_TAP=y  
CONFIG\_XEN\_BLKDEV_BACKEND=y  
"

\# initramfs에 필요한 설정들  
configs="$configs  
CONFIG\_MD\_RAID0=y  
CONFIG\_MD\_RAID1=y  
CONFIG\_MD\_RAID10=y  
CONFIG\_MD\_RAID456=y  
"

config_script='scripts/config'

for _config in $configs ; do  
key=\`echo $_config | awk 'BEGIN {FS="=";} {print $1}'\`  
value=\`echo $_config | awk 'BEGIN {FS="=";} {print $2}'\`

case "$value" in  
y)  
$config_script -enable $key  
;;  
m)  
$config_script -module $key  
;;  
*)  
$config_script -disable $key  
esac  
done  
[/code]

  * Update: BLKDEV_TAP 추가 (blktap2 디바이스 사용